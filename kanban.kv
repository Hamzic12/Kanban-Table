<app_layout>:

    task: task
    days: days

    orientation: 'horizontal'
    
    # the main grid 

    GridLayout:  
        cols: 2
        size: root.width, root.height 

        # grid of 3 parts, the whole table

        GridLayout:  
            id: table_grid_id
            cols: 1
            rows: 3
            
            GridLayout:  # stages for the kanban table
                id: stage_id
                cols: 4
                size_hint_y: 0.11  # Takes 20% of the vertical space
                # Optionally adjust the height proportion based on parent size

                Label:
                    text: "To Do"
                    canvas.before:
                        Color:
                            rgba: 1, 0, 0, 1  # Red
                        Rectangle:
                            pos: self.pos
                            size: self.size

                Label:
                    text: "In Progress"
                    canvas.before:
                        Color:
                            rgba: 1, 0, 0, 1  # Red
                        Rectangle:
                            pos: self.pos
                            size: self.size

                        Color:
                            rgba: 0, 0, 0, 1  # Border color (black)
                        Line: # Draw the left border
                            points: [self.x, self.y, self.x, self.y + self.height]
                            width: 2
                        Line: # Draw the right border
                            points: [self.x + self.width, self.y, self.x + self.width, self.y + self.height]
                            width: 2

                Label:
                    text: "Testing"
                    canvas.before:
                        Color:
                            rgba: 1, 0, 0, 1  # Red
                        Rectangle:
                            pos: self.pos
                            size: self.size
                        Color:
                            rgba: 0, 0, 0, 1  # Border color (black)
                        Line: # Draw the right border
                            points: [self.x + self.width, self.y, self.x + self.width, self.y + self.height]
                            width: 2
                        Line: # Draw the left border
                            points: [self.x, self.y, self.x, self.y + self.height]
                            width: 2

                Label:
                    text: "Done"
                    canvas.before:
                        Color:
                            rgba: 1, 0, 0, 1  # Red 
                        Rectangle:
                            pos: self.pos
                            size: self.size
                        Color:
                            rgba: 0, 0, 0, 1  # Border color (black)
                        Line: # Draw the right border
                            points: [self.x + self.width, self.y, self.x + self.width, self.y + self.height]
                            width: 2
                        Line: # Draw the left border
                            points: [self.x, self.y, self.x, self.y + self.height]
                            width: 2 

            
            # place for tasks

            RelativeLayout:  
                id: table_id
                Widget:
                    canvas.before:
                        Color:
                            rgba: 1, 1, 1, 1  # Border color (black)
                        Line:
                            points: [self.x, self.y, self.x + self.width, self.y]
                            width: 3

                Widget:
                    canvas.before:
                        Color:
                            rgba: 1, 1, 1, 1  # Border color (black)
                        Line:
                            points: [self.x, self.y + self.height, self.x + self.width, self.y + self.height]
                            width: 2
                 # Vertical lines separating columns
                Widget:
                    canvas.before:
                        Color:
                            rgba: 1, 1, 1, 1  # White color for the lines
                        Line:
                            points: [self.x + self.width / 4, self.y, self.x + self.width / 4, self.y + self.height]  # First vertical line
                            width: 2
                        Line:
                            points: [self.x + self.width / 2, self.y, self.x + self.width / 2, self.y + self.height]  # Second vertical line
                            width: 2
                        Line:
                            points: [self.x + 3 * self.width / 4, self.y, self.x + 3 * self.width / 4, self.y + self.height]  # Third vertical line
                            width: 2

                # White line on the right side where you drew the blue line
                Widget:
                    canvas.before:
                        Color:
                            rgba: 1, 1, 1, 1  # White line color
                        Line:
                            points: [self.x + self.width, self.y, self.x + self.width, self.y + self.height]  # Line on the far right
                            width: 1


            # bar showing progress

            GridLayout:  
                id: progress_id
                cols: 45
                size_hint_y: 0.1  # Takes 30% of the vertical space

                Widget:
                    canvas:
                        Color:
                            rgba: 0, root.f1, 0, 1  # Adjust color dynamically with root.f1
                        Rectangle:
                            pos: self.pos
                            size: self.size
                        Color:
                            rgba: 0, 0, 0, 1  # Border color (black)
                        Line:
                            rectangle: (self.x, self.y, self.width, self.height)
                            width: 1 

                Widget:
                    canvas:
                        Color:
                            rgba: 0, root.f2, 0, 1  # Adjust color dynamically with root.f2
                        Rectangle:
                            pos: self.pos
                            size: self.size
                        Color:
                            rgba: 0, 0, 0, 1  # Border color (black)
                        Line:
                            rectangle: (self.x, self.y, self.width, self.height)
                            width: 1 

                Widget:
                    canvas:
                        Color:
                            rgba: 0, root.f3, 0, 1  # Adjust color dynamically with root.f3
                        Rectangle:
                            pos: self.pos
                            size: self.size
                        Color:
                            rgba: 0, 0, 0, 1  # Border color (black)
                        Line:
                            rectangle: (self.x, self.y, self.width, self.height)
                            width: 1 

                Widget:
                    canvas:
                        Color:
                            rgba: 0, root.f4, 0, 1  # Adjust color dynamically with root.f4
                        Rectangle:
                            pos: self.pos
                            size: self.size
                        Color:
                            rgba: 0, 0, 0, 1  # Border color (black)
                        Line:
                            rectangle: (self.x, self.y, self.width, self.height)
                            width: 1
                Widget:
                    canvas:
                        Color:
                            rgba: 0, root.f5, 0, 1  # Adjust color dynamically with root.f4
                        Rectangle:
                            pos: self.pos
                            size: self.size
                        Color:
                            rgba: 0, 0, 0, 1  # Border color (black)
                        Line:
                            rectangle: (self.x, self.y, self.width, self.height)
                            width: 1 

          # user interface

        StackLayout:
            id: ui_id
            size_hint_x: 0.3  # This is for the horizontal space
            orientation: 'lr-bt'
            spacing : "5 dp"
            
            Button:
                text: "Save"
                size_hint: 0.5, 0.1
                on_press: root.save_progress()

            Button:
                text: "Clear table"
                size_hint: 0.5, 0.1
                on_press: root.clear_table()

            Button:
                text: "Right"
                size_hint: 0.5, 0.1
                on_press: root.move_right()

            Button:
                text: "Left"
                size_hint: 0.5, 0.1
                on_press: root.move_left()
            
            Button:
                text: "Add"
                size_hint: 0.5, 0.1
                on_press: root.add_task()
                disabled: root.disabled_add
            
            Button:
                text: "Remove"
                size_hint: 0.5, 0.1
                on_press: root.delete_task()

            TextInput:
                id : days
                hint_text: "Enter the days it will take"
                multiline: False
                size_hint: 1, 0.05

            TextInput:
                id: task
                hint_text: "Enter the task"
                multiline: False
                size_hint: 1, 0.1

            